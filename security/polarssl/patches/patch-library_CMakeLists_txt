$OpenBSD$

Allow both shared and static PolarSSL library :
https://github.com/jmesmon/buildroot/blob/master/package/polarssl/polarssl-shared-and-static-library.patch

--- library/CMakeLists.txt.orig	Tue Mar 18 16:07:15 2014
+++ library/CMakeLists.txt	Tue Mar 18 16:09:38 2014
@@ -1,4 +1,5 @@
-option(USE_SHARED_POLARSSL_LIBRARY "Build PolarSSL as a shared library." OFF)
+option(USE_SHARED_POLARSSL_LIBRARY "Build PolarSSL as a shared library." ON)
+option(USE_STATIC_POLARSSL_LIBRARY "Build PolarSSL as a static library." ON)
 
 set(src
      aes.c
@@ -77,23 +78,28 @@
   set(CMAKE_C_FLAGS_CHECKFULL "${CMAKE_C_FLAGS_CHECK} -Wcast-qual")
 endif(CMAKE_COMPILER_IS_GNUCC)
 
-if(NOT USE_SHARED_POLARSSL_LIBRARY)
+if(USE_SHARED_POLARSSL_LIBRARY)
 
-add_library(polarssl STATIC ${src})
-
-else(NOT USE_SHARED_POLARSSL_LIBRARY)
-
 add_library(polarssl SHARED ${src})
 set_target_properties(polarssl PROPERTIES VERSION 1.3.4 SOVERSION 5)
 
-endif(NOT USE_SHARED_POLARSSL_LIBRARY)
+set_target_properties(polarssl PROPERTIES OUTPUT_NAME polarssl)
 
+endif(USE_SHARED_POLARSSL_LIBRARY)
+
+if(USE_STATIC_POLARSSL_LIBRARY)
+
+add_library(polarssl-static STATIC ${src})
+set_target_properties(polarssl-static PROPERTIES OUTPUT_NAME polarssl)
+
+endif(USE_STATIC_POLARSSL_LIBRARY)
+
 target_link_libraries(polarssl ${libs})
 
 if(ZLIB_FOUND)
 target_link_libraries(polarssl ${ZLIB_LIBRARIES})
 endif(ZLIB_FOUND)
 
-install(TARGETS polarssl
+install(TARGETS polarssl polarssl-static
         DESTINATION ${LIB_INSTALL_DIR}
         PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
