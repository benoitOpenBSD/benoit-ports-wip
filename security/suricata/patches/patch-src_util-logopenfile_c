--- src/util-logopenfile.c~	Wed Jan 11 19:07:22 2012
+++ src/util-logopenfile.c	Sun Jan 15 12:46:36 2012
@@ -23,7 +23,9 @@
  *
  * File-like output for logging:  regular files and sockets.
  */
+#if HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
+#endif
 #include <sys/un.h>
 
 #include "suricata-common.h" /* errno.h, string.h, etc. */
