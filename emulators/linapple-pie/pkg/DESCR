Port of linapple2b optimized for front end usage.
